<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Getting Started with ml5.js</title>
		<!-- p5 -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.2.0/p5.min.js"></script>
		<!-- ml5 -->
		<script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
	</head>

	<body>
		<div id="canvas"></div>
		<script>
			let mobileNet;
			let predictions = [];
			function setup() {
				let canvas = createCanvas(600, 600);
				canvas.parent("canvas");
				let myImage = createImg(
					"images/plain-chair.jpeg",
					"an image",
					"",
					() => {
						console.log("the image has loaded");
						myImage.hide();
						image(myImage, 0, 0, width, height);
						mobileNet = ml5.imageClassifier("MobileNet", () => {
							console.log("the model is ready");
							mobileNet.predict(myImage, (error, results) => {
								if (error) {
									console.error(error);
								} else {
									console.log(results);
									predictions = results;
								}
							});
						});
					}
				);
			}

			function draw() {
				//draw the results to the canvas
				fill(0, 255, 2);
				textSize(24);
				let ypos = 400;
				for (i = 0; i < predictions.length; i++) {
					let label = predictions[i].label;
					let estimate = predictions[i].confidence * 100;
					estimate = estimate.toFixed(1);
					text(`${label}, with ${estimate}% confidence.`, 30, ypos);
					ypos += 34;
				}
			}
		</script>
	</body>
</html>
